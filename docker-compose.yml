version: "3.9"
services:

    mock-database:
        image: saheru/fbthrift-benchmark
        hostname: mock-database
        ports:
            - 10001:10001
        command: ["/app/src/build/MockDatabase/MockDatabase", "1", "8"]

    sanitization-service:
        image: saheru/fbthrift-benchmark
        hostname: sanitization-service
        ports:
            - 10003:10003
        command: ["/app/src/build/SanitizationService/SanitizationServiceServer", "1", "8"]
        depends_on:
            - mock-database

    message-service:
        image: saheru/fbthrift-benchmark
        hostname: message-service
        ports:
            - 10002:10002
        command: ["/app/src/build/MessageService/MessageServiceServer", "1", "8"]
        depends_on:
            - mock-database
            - sanitization-service

    client:
        image: saheru/fbthrift-benchmark
        hostname: client
        restart: always
        command: ["/app/src/build/Client/client", "64"]
        depends_on:
            - message-service

    # sanitization-service-client:
    #     image: saheru/fbthrift-benchmark
    #     hostname: client-1
    #     # restart: always
    #     command: ["./src/build/SanitizationService/SanitizationServiceClient"]
    #     depends_on:
    #         - sanitization-service

    # mock-client:
    #     image: saheru/fbthrift-benchmark
    #     hostname: mock-client
    #     # restart: always
    #     command: ["./src/build/MockDatabase/MockDatabaseClient", "100"]

    #     depends_on:
    #         - mock-database
    #         # - mock-database-middle

    # mock-database-middle:
    #     image: saheru/fbthrift-benchmark
    #     hostname: mock-database-middle
    #     ports:
    #         - 10011:10011
    #     command: ["./src/build/MockDatabase/MockDatabaseMiddle"]
    #     depends_on:
    #         - mock-database
